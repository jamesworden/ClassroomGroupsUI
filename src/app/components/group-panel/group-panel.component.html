<div class="panel rounded-lg flex-col gap-y-2 px-4 pt-4 pb-2 shadow-lg">
  <div class="flex justify-between">
    <div class="flex gap-x-2">
      <div class="flex flex-col justify-around">
        <ng-content></ng-content>
      </div>

      <div class="flex flex-col justify-around">
        <mat-checkbox color="primary"></mat-checkbox>
      </div>

      <div class="flex flex-col justify-around">
        <h6 style="margin: 0">{{ group()?.label }}</h6>
      </div>
    </div>

    <div class="flex gap-x-2">
      <div
        [matTooltip]="
          studentsInGroup().length > 0
            ? 'You can\'t delete group that contains students'
            : ''
        "
      >
        <button
          mat-icon-button
          (click)="deleteGroup()"
          [disabled]="studentsInGroup().length > 0"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
  </div>

  @if(students.length > 0) {
  <div
    cdkDropList
    [id]="group()?.id ?? ''"
    [cdkDropListConnectedTo]="viewingGroupIds()"
    class="example-list w-full my-2"
    (cdkDropListDropped)="drop($event)"
  >
    @for (student of students; track student.id) {
    <div
      class="example-box flex"
      cdkDrag
      cdkDragBoundary=".groups-boundary"
      cdkDragLockAxis="y"
    >
      @for(value of student.orderedValues; track i; let i = $index) {
      <div class="flex-1">
        <div>
          @if(editingOrderedFieldIndex === i && editingStudentId === student.id)
          {
          <input
            type="text"
            [value]="editingField"
            placeholder="Add value"
            class="outline-none bg-transparent border-none w-full text-ellipsis"
            (change)="saveEdits()"
          />
          } @else {
          <span
            class="cursor-text"
            (click)="startEditing(student.id, i, value)"
          >
            {{ value }}
          </span>
          }
        </div>
      </div>
      }
    </div>
    }
  </div>
  }

  <div class="flex justify-start">
    <div class="flex gap-x-2 text-sm">
      <div class="flex flex-col justify-around">
        <button mat-icon-button (click)="addStudent()">
          <mat-icon>person_add</mat-icon>
        </button>
      </div>

      <div class="flex flex-col justify-around">
        <span> Add student </span>
      </div>
    </div>
  </div>
</div>
