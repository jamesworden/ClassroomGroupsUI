<div
  cdkDropList
  [id]="groupId()!"
  [cdkDropListConnectedTo]="groupIds()"
  class="grid-row student-list overflow-hidden w-full"
  [ngClass]="{
    'min-h-12 border-4 border-dashed border-gray-300':
      editingStudents.length <= 0,
    'rounded-b-md': roundedBottom(),
    'rounded-t-md': roundedTop(),
  }"
  (cdkDropListDropped)="drop($event)"
>
  @for (student of editingStudents; track student.id) {
    <div
      class="grid-row student-row text-sm cursor-move flex border-b border-neutral-200 dark:border-neutral-600 p-2 flex"
      cdkDrag
    >
      @for (columnDetail of columnDetails(); track i; let i = $index) {
        <div class="flex-1">
          <div>
            @if (
              editingFieldId === columnDetail.fieldId &&
              editingStudentId === student.id
            ) {
              <input
                #valueInput
                type="text"
                [(ngModel)]="editingField"
                placeholder="Add value"
                class="outline-none bg-transparent border-none w-full text-ellipsis"
                (change)="saveEdits()"
              />
            } @else {
              <span
                class="cursor-text"
                [ngClass]="{
                  'opacity-50':
                    student.fieldIdsToValues[columnDetail.fieldId] ===
                      undefined ||
                    student.fieldIdsToValues[columnDetail.fieldId] === '',
                }"
                (click)="
                  startEditing(
                    columnDetail.fieldId,
                    student.fieldIdsToValues[columnDetail.fieldId],
                    student.id
                  )
                "
              >
                {{
                  student.fieldIdsToValues[columnDetail.fieldId] || 'Add value'
                }}
              </span>
            }
          </div>
        </div>
      }
    </div>
  }
</div>
