<div class="h-full w-full grid-bg flex flex-col overflow-x-hidden">
  <div class="flex flex-1 justify-around">
    <div class="px-4 max-w-7xl flex flex-col flex-1">
      <mat-toolbar>
        <span>Classrooms</span>

        <span class="flex-auto"></span>

        <button
          matTooltip="Home"
          mat-icon-button
          [routerLink]="['/']"
          class="!flex"
        >
          <mat-icon>arrow_back</mat-icon>
        </button>

        <app-code-links-menu-button></app-code-links-menu-button>

        <app-toggle-theme-button></app-toggle-theme-button>

        <app-account-menu-button></app-account-menu-button>

        <div
          class="flex flex-col justify-around ml-2"
          [matTooltip]="
            classroomDetails().length >=
            (account()?.subscription?.maxClassrooms ?? 0)
              ? 'Classroom limit reached!'
              : ''
          "
        >
          <button
            class="bg-gradient-fade !text-white"
            matTooltip="Add classroom"
            mat-icon-button
            (click)="createClassroom()"
            [disabled]="
              classroomDetails().length >=
              (account()?.subscription?.maxClassrooms ?? 0)
            "
            [ngClass]="{
              '!opacity-50':
                classroomDetails().length >=
                (account()?.subscription?.maxClassrooms ?? 0),
            }"
          >
            <mat-icon>add</mat-icon>
          </button>
        </div>
      </mat-toolbar>

      <!-- Existing classroom cards or empty state -->
      @if (classroomDetails().length > 0) {
        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 flex-1"
        >
          @for (classroom of classroomDetails(); track classroom.id) {
            <app-classroom-card
              [classroom]="classroom"
              (viewed)="viewClassroom(classroom.id)"
              (deleted)="openDeleteClassroomDialog(classroom)"
            ></app-classroom-card>
          }
        </div>
      } @else if (!classroomsLoading()) {
        <div
          class="flex flex-col lg:flex-row items-center justify-between w-full p-8 rounded-xl bg-white dark:bg-gray-800 shadow-md mt-8"
        >
          <div class="flex flex-col items-start max-w-md mb-8 lg:mb-0 lg:pr-8">
            <div class="mb-2 text-primary">
              <mat-icon class="text-4xl big-icon">school</mat-icon>
            </div>

            <h2 class="text-2xl font-semibold mb-4">
              Your Teaching Journey Starts Here
            </h2>

            <p class="opacity-80 mb-6">
              Create your first classroom to begin organizing students,
              assignments, and educational resources in one place. Managing your
              teaching has never been easier.
            </p>

            <button
              mat-raised-button
              color="primary"
              class="px-6 py-2 rounded-md flex items-center"
              (click)="createClassroom()"
            >
              <mat-icon class="mr-2">add</mat-icon>
              Create classroom
            </button>
          </div>

          <div class="flex-shrink-0 max-w-md w-full lg:max-w-lg">
            <img
              class="w-full object-contain"
              [src]="
                theme() === Themes.LIGHT
                  ? 'assets/add-classroom-light.svg'
                  : 'assets/add-classroom-dark.svg'
              "
              alt="Classroom illustration"
            />
          </div>
        </div>
      } @else {
        <div class="flex justify-center items-center h-64">
          <mat-spinner></mat-spinner>
        </div>
      }

      @if (
        classroomDetails().length <
        (account()?.subscription?.maxClassrooms ?? 0)
      ) {
        <div class="my-8 w-full flex-1 flex flex-col justify-around">
          <div
            class="cursor-pointer rounded-lg border border-3 border-dashed border-gray-400 dark:border-gray-500 transition-colors"
            [ngClass]="{
              'border-black dark:border-white': isDragging(),
            }"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onDrop($event)"
            (click)="fileInput.click()"
          >
            <input
              #fileInput
              type="file"
              accept=".csv"
              class="hidden"
              (change)="onFileSelected($event)"
            />
            <div class="flex flex-col items-center justify-center p-8">
              <div [ngClass]="{ 'animate-pulse': isDragging() }">
                <mat-icon class="text-6xl big-icon text-gradient-fade"
                  >cloud_upload</mat-icon
                >
              </div>
              <h3 class="text-xl font-medium mb-2">Import Classroom Data</h3>
              <p class="text-center opacity-75 max-w-md">
                Import your classroom data by dropping a CSV file here, or click
                to browse
              </p>
              <div class="mt-4 flex items-center">
                <span class="text-sm opacity-60">Supported format: CSV</span>
              </div>
            </div>
          </div>
        </div>
      } @else {
        <!-- Flex Placeholder -->
        <div class="flex-1"></div>
      }
    </div>
  </div>

  <footer class="py-4 text-center text-gray-500 text-sm">
    <p>Â© {{ fullYear }} ClassroomGroups. All rights reserved.</p>
  </footer>
</div>
